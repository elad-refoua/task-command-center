<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מרכז המשימות | Task Command Center</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <button class="menu-toggle" id="menuToggle" aria-label="תפריט">☰</button>
        <h1 class="logo">🎯 מרכז המשימות</h1>
        <div class="header-actions">
            <button class="btn btn-icon" id="refreshBtn" title="רענון">🔄</button>
            <button class="btn btn-icon" id="notificationsBtn" title="התראות">🔔</button>
            <button class="btn btn-icon" id="settingsBtn" title="הגדרות">⚙️</button>
        </div>
    </header>

    <!-- Mobile Sidebar -->
    <aside class="sidebar" id="sidebar">
        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-view="tasks">📋 משימות</a>
            <a href="#" class="nav-item" data-view="scheduled">📅 מתוזמנות</a>
            <a href="#" class="nav-item" data-view="agents">🤖 סוכנים</a>
            <a href="#" class="nav-item" data-view="skills">⚡ כישורים</a>
            <a href="#" class="nav-item" data-view="health">🏥 בריאות</a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Statistics Cards -->
        <section class="stats-section">
            <div class="stat-card">
                <span class="stat-value" id="totalTasks">0</span>
                <span class="stat-label">סה״כ משימות</span>
            </div>
            <div class="stat-card stat-pending">
                <span class="stat-value" id="pendingTasks">0</span>
                <span class="stat-label">ממתינות</span>
            </div>
            <div class="stat-card stat-failed">
                <span class="stat-value" id="failedTasks">0</span>
                <span class="stat-label">נכשלו</span>
            </div>
            <div class="stat-card stat-completed">
                <span class="stat-value" id="completedTasks">0</span>
                <span class="stat-label">הושלמו</span>
            </div>
        </section>

        <!-- Health Status Banner -->
        <section class="health-banner" id="healthBanner">
            <span class="health-icon">✅</span>
            <span class="health-text">בדיקה אחרונה: <span id="lastCheck">טוען...</span></span>
            <span class="health-status" id="healthStatus">תקין</span>
            <button class="btn btn-health-check" id="runHealthCheckBtn" title="הרץ בדיקה עכשיו">
                🔍 בדוק עכשיו
            </button>
        </section>

        <!-- Health Check Results Modal -->
        <div class="health-results-modal" id="healthResultsModal">
            <div class="health-results-content">
                <div class="health-results-header">
                    <h3>📊 תוצאות בדיקה</h3>
                    <button class="modal-close" id="closeHealthResults">&times;</button>
                </div>
                <div class="health-results-body" id="healthResultsBody">
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <span>מריץ בדיקה...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filter Bar -->
        <section class="filter-bar">
            <div class="filter-group">
                <select id="filterSource" class="filter-select">
                    <option value="all">כל המקורות</option>
                    <option value="scheduled">מתוזמנות</option>
                    <option value="session">סשן</option>
                    <option value="project">פרויקט</option>
                </select>
                <select id="filterStatus" class="filter-select">
                    <option value="all">כל הסטטוסים</option>
                    <option value="pending">ממתין</option>
                    <option value="in_progress">בביצוע</option>
                    <option value="completed">הושלם</option>
                    <option value="failed">נכשל</option>
                </select>
            </div>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="🔍 חיפוש משימות..." class="search-input">
            </div>
        </section>

        <!-- Trello-Style Board -->
        <section class="board-section">
            <div class="board-header">
                <h2>📋 לוח משימות</h2>
                <div class="board-actions">
                    <button class="btn btn-primary" id="newTaskBtn">+ משימה חדשה</button>
                    <button class="btn btn-secondary" id="toggleViewBtn" title="החלף תצוגה">⊞</button>
                </div>
            </div>
            <div class="board-container" id="boardContainer">
                <!-- Columns will be rendered here -->
                <div class="loading-spinner" id="tasksLoading">
                    <div class="spinner"></div>
                    <span>טוען משימות...</span>
                </div>
            </div>
        </section>

        <!-- Quick Fix Panel (Floating) -->
        <aside class="quick-fix-panel floating" id="quickFixPanel">
            <div class="quick-fix-header">
                <h3>⚡ תיקון מהיר</h3>
                <button class="btn btn-icon btn-small" id="toggleQuickFix">−</button>
            </div>
            <div class="quick-fix-body">
                <p class="panel-description">שלח משימה מיידית לקלוד</p>
                <div class="quick-fix-form">
                    <textarea
                        id="quickFixInput"
                        placeholder="תאר את המשימה..."
                        rows="3"
                    ></textarea>
                    <div class="quick-fix-options">
                        <select id="quickFixAgent" class="filter-select">
                            <option value="">סוכן אוטומטי</option>
                            <option value="Explore">🔍 Explore</option>
                            <option value="Plan">📋 Plan</option>
                            <option value="Browser">🌐 Browser</option>
                        </select>
                    </div>
                    <button class="btn btn-primary btn-block" id="quickFixBtn">
                        🚀 שלח עכשיו
                    </button>
                </div>
                <div class="recent-fixes">
                    <h4>אחרונים:</h4>
                    <ul id="recentFixes" class="recent-list">
                        <!-- Recent quick fixes -->
                    </ul>
                </div>
            </div>
        </aside>

        <!-- Agents & Skills Section -->
        <section class="bottom-panels">
            <!-- Agents Panel -->
            <div class="panel agents-panel">
                <div class="panel-header">
                    <h3>🤖 סוכנים</h3>
                    <span class="drag-hint">גרור לכרטיס משימה להקצאה</span>
                </div>
                <div class="agents-list" id="agentsList">
                    <!-- Agents will be rendered here with draggable -->
                </div>
            </div>

            <!-- Skills Panel -->
            <div class="panel skills-panel">
                <div class="panel-header">
                    <h3>⚡ כישורים</h3>
                    <span class="drag-hint">גרור לכרטיס משימה להקצאה</span>
                </div>
                <div class="skill-creator">
                    <input
                        type="text"
                        id="skillDescription"
                        placeholder="תאר כישור חדש..."
                        class="skill-input"
                    >
                    <button class="btn btn-primary btn-small" id="createSkillBtn">
                        ✨ צור
                    </button>
                </div>
                <div class="skills-browser">
                    <input type="text" id="skillSearch" placeholder="🔍 חפש..." class="search-input small">
                    <div class="skills-list-container">
                        <ul id="skillsList" class="skills-list">
                            <!-- Skills will be rendered here with draggable -->
                        </ul>
                    </div>
                    <div class="skills-count">
                        <span id="skillsCount">0</span> כישורים
                    </div>
                </div>
            </div>
        </section>

        <!-- Health Log Section -->
        <section class="health-log-section">
            <div class="section-header">
                <h3>📊 יומן בריאות</h3>
                <button class="btn btn-small" id="viewAllHealthBtn">הצג הכל</button>
            </div>
            <div class="health-log" id="healthLog">
                <!-- Health log entries -->
            </div>
        </section>
    </main>

    <!-- New Task Modal -->
    <div class="modal" id="newTaskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>משימה חדשה</h3>
                <button class="modal-close" id="closeNewTaskModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>כותרת:</label>
                    <input type="text" id="newTaskTitle" placeholder="מה צריך לעשות?">
                </div>
                <div class="form-group">
                    <label>תיאור:</label>
                    <textarea id="newTaskDescription" rows="4" placeholder="פרטים נוספים..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>סוכן:</label>
                        <select id="newTaskAgent">
                            <option value="">אוטומטי</option>
                            <option value="Explore">Explore</option>
                            <option value="Plan">Plan</option>
                            <option value="Browser">Browser</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>כישור:</label>
                        <select id="newTaskSkill">
                            <option value="">ללא</option>
                            <!-- Skills will be populated -->
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>תזמון:</label>
                    <div class="schedule-options">
                        <label class="radio-label">
                            <input type="radio" name="schedule" value="now" checked> מיידי
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="schedule" value="later"> מאוחר יותר
                        </label>
                    </div>
                    <input type="datetime-local" id="scheduleTime" class="schedule-time hidden">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelNewTask">ביטול</button>
                <button class="btn btn-primary" id="saveNewTask">שמור משימה</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="app.js"></script>
</body>
</html>
